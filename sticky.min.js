'use strict';(function(h){function q(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b],e;for(e in d)a[e]=d[e]}return a}function k(a){var b={top:0,left:0,right:0,bottom:0,width:0,height:0},c=a.getBoundingClientRect();b.top=c.top+(window.pageYOffset||document.documentElement.scrollTop);b.left=c.left+(window.pageXOffset||document.documentElement.scrollLeft);b.width=a.offsetWidth;b.height=a.offsetHeight;b.right=document.width-c.right;b.bottom=window.innerHeight+(window.pageYOffset||document.documentElement.scrollTop)-
c.bottom;return b}function l(a,b){var c=getComputedStyle(b),d=k(b),e=0,f=0;"border-box"!==c["box-sizing"]&&(e=~~c.paddingLeft.slice(0,-2),f=~~c.paddingRight.slice(0,-2));a.style.width=d.width-e-f+"px";a.style.left=d.left+"px";for(d=a.style.marginLeft=0;d<m.length;d++)for(e=0;e<n.length;e++)f=m[d]+n[e],a.style[f]=c[f]}function f(){this.create.apply(this,arguments)}var p=["object","iframe","embed","img"],n=["left","top","right","bottom"],m=["padding-","border-"];f.list=[];f.p=[];f.stack={};f.prototype=
{options:{offset:0,restrictWithin:null,vAlign:"top",stickyClass:"is-stuck",stubClass:"sticky-stub",stack:null,collapse:!0},create:function(a,b){if(void 0===a.getAttribute("data-sticky-id"))return console.log("Sticky already exist");this.a=a;this.parent=this.a.parentNode;var c=a.dataset;c||(c={},a.getAttribute("data-restrict-within")&&(c.restrictWithin=a.getAttribute("data-restrict-within")),a.getAttribute("data-offset")&&(c.offset=a.getAttribute("data-offset")),a.getAttribute("data-stack")&&(c.stack=
a.getAttribute("data-stack")),a.getAttribute("data-sticky-class")&&(c.stickyClass=a.getAttribute("data-sticky-class")));this.options=q({},this.options,c,b);this.restrictWithin="string"===typeof this.options.restrictWithin&&this.options.restrictWithin.trim()?document.body.querySelector(this.options.restrictWithin):this.options.restrictWithin;this.a.setAttribute("data-sticky-id",f.list.length);this.id=f.list.length;f.list.push(this);this.d=this.k=!1;this.e=!0;this.c={top:0,bottom:9999};this.height=
0;this.l={top:0,height:0};this.options.offset=parseFloat(this.options.offset)||0;this.offset={top:0,bottom:0};this.g=[];this.stack=[];if(this.options.stack)for(var c=this.options.stack.split(","),d=c.length;d--;)c[d]=c[d].trim(),f.stack[c[d]]||(f.stack[c[d]]=[]),this.g[d]=f.stack[c[d]].length,this.stack.push(c[d]),f.stack[c[d]].push(this);else this.g[0]=f.p.length,f.p.push(this);c=this.a.cloneNode(!0);for(d=0;d<p.length;d++)for(var e=c.querySelectorAll(p[d]),g=e.length;g--;)e[g].removeAttribute("src"),
e[g].removeAttribute("href"),e[g].removeAttribute("rel"),e[g].removeAttribute("srcdoc"),"SCRIPT"===e[g].tagName&&e[g].parentNode.replaceChild(e[g]);this.b=c;this.b.classList.add(this.options.stubClass);this.b.style.visibility="hidden";this.b.style.display="none";this.b.removeAttribute("hidden");this.j=this.a.style.cssText;this.o=getComputedStyle(this.a).display;"static"==getComputedStyle(this.parent).position&&(this.parent.style.position="relative");this.h=this.h.bind(this);this.recalc=this.recalc.bind(this);
this.disable=this.disable.bind(this);this.enable=this.enable.bind(this);this.n=this.n.bind(this);this.m=this.m.bind(this);document.addEventListener("sticky:recalc",this.recalc);this.a.addEventListener("sticky:recalc",this.recalc);this.a.addEventListener("DOMNodeRemoved",this.disable);this.a.addEventListener("DOMNodeInserted",this.enable);this.a.addEventListener("sticky:disable",this.disable);this.a.addEventListener("sticky:enable",this.enable);"none"===this.o?(this.o="block",this.disable()):this.enable()},
disable:function(){this.b.parentNode&&this.parent.removeChild(this.b);this.w();document.dispatchEvent(new CustomEvent("sticky:recalc"))},enable:function(){this.parent.insertBefore(this.b,this.a);this.n();this.recalc();document.dispatchEvent(new CustomEvent("sticky:recalc"))},n:function(){document.addEventListener("scroll",this.h);window.addEventListener("resize",this.recalc)},w:function(){document.addEventListener("scroll",this.h);window.addEventListener("resize",this.recalc)},h:function(){var a=
window.pageYOffset||document.documentElement.scrollTop;if(this.k)!this.e&&a+this.offset.top+this.options.offset+this.height+this.f+this.i>=this.c.bottom-this.offset.bottom&&this.t(),!this.d&&a+this.offset.top+this.options.offset+this.f<=this.c.top&&this.u();else if(this.e||this.d)a+this.offset.top+this.options.offset+this.f>this.c.top?a+this.offset.top+this.options.offset+this.height+this.f+this.i<this.c.bottom-this.offset.bottom?this.q():this.d||(this.q(),this.t()):this.d&&(this.q(),this.u())},u:function(){this.a.style.cssText=
this.j;this.a.classList.remove(this.options.stickyClass);this.b.style.display="none";this.k=!1;this.e=!0;this.d=!1},q:function(){this.b.style.display=this.o;this.s(this.a);this.k=!0;this.d=this.e=!1},t:function(){this.a.classList.remove(this.options.stickyClass);this.r(this.a);this.k=!1;this.d=!0;this.e=!1},r:function(a){a.style.cssText=this.j;a.style.position="absolute";a.style.top=this.c.bottom-this.offset.bottom-this.l.top-this.height-this.f-this.i+"px";l(a,this.b);a.style.left=this.b.offsetLeft+
"px"},s:function(a,b){a.style.cssText=this.j;a.style.position="fixed";a.style.top=this.offset.top+this.options.offset+"px";a.classList.add(this.options.stickyClass);l(a,b||this.b)},recalc:function(){var a=this.e?this.a:this.b;this.l=k(this.parent);this.height=this.a.offsetHeight;var b=getComputedStyle(a);b.marginLeft.slice(0,-2);b.marginRight.slice(0,-2);this.f=~~b.marginTop.slice(0,-2);this.i=~~b.marginBottom.slice(0,-2);this.restrictWithin instanceof Element?(b=k(this.restrictWithin),this.c.top=
Math.max(b.top,k(a).top),this.c.bottom=this.restrictWithin.offsetHeight+b.top):this.restrictWithin instanceof Object?this.c=this.restrictWithin:(this.c.top=k(a).top,this.c.bottom=this.l.height+this.l.top);this.offset.bottom=0;this.offset.top=0;if(this.stack.length)for(var c=this.stack.length;c--;){if(b=f.stack[this.stack[c]][this.g[c]-1]){var d=b.e?b.a:b.b;this.offset.top=b.offset.top+b.options.offset;var e;if(!(e=!this.options.collapse)){e=a.offsetLeft;var g=a.offsetLeft+a.offsetWidth,h=d.offsetLeft,
d=d.offsetWidth+d.offsetLeft;e=g<h&&e<h||g>d&&e>d?!1:!0}if(e)for(this.offset.top+=b.height+Math.max(b.f,b.i),d=f.stack[this.stack[c]][this.g[c]],e=this.g[c]-1;b=f.stack[this.stack[c]][e];e--)b.offset.bottom=Math.max(b.offset.bottom,d.offset.bottom+d.height+d.f+d.i),d=b}}else if(b=f.p[this.g[0]-1])b.c.bottom=this.c.top-this.f;clearTimeout(this.v);this.v=setTimeout(this.m,0)},m:function(){this.e?this.a.style.cssText=this.j:this.d?this.r(this.a):this.s(this.a);this.h()}};h?h.fn.sticky=function(a){return this.each(function(b,
c){var d=h(c),e=new f(d[0],a);d.data("sticky",e)})}:window.Sticky=f})(window.jQuery||window.Zepto);
