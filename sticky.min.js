'use strict';(function(h) {
  function k(a) {
    for(var b = 1, c = arguments.length;b < c;b++) {
      var d = arguments[b], e;
      for(e in d) {
        a[e] = d[e]
      }
    }
    return a
  }
  function g(a) {
    var b = {top:0, left:0, right:0, bottom:0, width:0, height:0}, c = a.getBoundingClientRect();
    b.top = c.top + (window.pageYOffset || document.documentElement.scrollTop);
    b.left = c.left + (window.pageXOffset || document.documentElement.scrollLeft);
    b.width = a.offsetWidth;
    b.height = a.offsetHeight;
    b.right = document.width - c.right;
    b.bottom = window.innerHeight + (window.pageYOffset || document.documentElement.scrollTop) - c.bottom;
    return b
  }
  function f() {
    this.create.apply(this, arguments)
  }
  f.list = [];
  f.prototype = {options:{offset:0, g:null, vAlign:"top", m:"is-stuck", D:"sticky-stub", mode:"exclusive"}, create:function(a, b) {
    this.a = a;
    this.options = k({}, this.options, a.dataset, b);
    this.g = "string" === typeof this.options.restrictWithin ? document.body.querySelector(this.options.restrictWithin) : this.options.restrictWithin;
    this.options.offset = parseFloat(this.options.offset) || 0;
    this.a.v = f.list.length;
    f.list.push(this);
    this.e = this.j = !1;
    this.f = !0;
    this.b = {top:0, bottom:9999};
    this.height = 0;
    this.parent = {top:0, height:0};
    for(var c = this.a;null !== (c = c.previousSibling);) {
      if(void 0 !== c.v) {
        this.d = f.list[c.v];
        this.d.F = this;
        break
      }
    }
    this.c = this.a.cloneNode(!0);
    this.c.classList.add(this.options.D);
    this.c.style.visibility = "hidden";
    this.B = this.a.style.cssText;
    this.h = this.a.cloneNode(!0);
    this.w = document.createDocumentFragment();
    "static" == window.getComputedStyle(this.a.parentNode).position && (this.a.parentNode.style.position = "relative");
    this.i = this.i.bind(this);
    this.recalc = this.recalc.bind(this);
    this.k = this.k.bind(this);
    this.recalc();
    document.addEventListener("scroll", this.i);
    window.addEventListener("resize", this.recalc);
    document.addEventListener("sticky:recalc", this.recalc)
  }, i:function() {
    var a = window.pageYOffset || document.documentElement.scrollTop;
    this.j ? (!this.f && a + this.options.offset + this.height >= this.b.bottom && this.s(), !this.e && a + this.options.offset <= this.b.top && this.C()) : (this.f || this.e) && a + this.options.offset > this.b.top && (a + this.options.offset + this.height < this.b.bottom ? this.u() : this.e || (this.u(), this.s()))
  }, C:function() {
    this.c = this.a.parentNode.removeChild(this.c);
    this.p();
    this.a.classList.remove(this.options.m);
    this.j = !1;
    this.f = !0;
    this.e = !1
  }, u:function() {
    this.e ? this.t(this.h) : this.t(this.c, this.h);
    this.l(this.h, this.a);
    this.a = this.a.parentNode.replaceChild(this.w, this.a);
    this.l(this.a);
    this.h = this.c.parentNode.replaceChild(this.a, this.h);
    this.j = !0;
    this.e = this.f = !1
  }, s:function() {
    this.a.classList.remove(this.options.m);
    this.q(this.a);
    this.j = !1;
    this.e = !0;
    this.f = !1
  }, q:function(a) {
    a.style.cssText = "";
    a.style.position = "absolute";
    a.style.top = this.b.bottom - this.parent.top - this.height + "px";
    this.r(a, this.c);
    a.style.left = this.c.offsetLeft + "px"
  }, l:function(a, b) {
    a.style.cssText = "";
    a.style.position = "fixed";
    a.style.top = this.options.offset + "px";
    a.classList.add(this.options.m);
    this.r(a, b || this.c)
  }, t:function() {
    for(var a = 0;a < arguments.length;a++) {
      this.w.appendChild(arguments[a])
    }
  }, recalc:function() {
    var a = this.f ? this.a : this.c;
    this.parent = g(a.parentNode);
    this.height = a.offsetHeight;
    if(this.g instanceof Element) {
      var b = g(this.g);
      this.b.top = Math.max(b.top, g(a).top);
      this.b.bottom = this.g.offsetHeight + b.top
    }else {
      this.g instanceof Object ? this.b = this.g : (this.b.top = g(a).top, this.b.bottom = this.parent.height + this.parent.top)
    }
    this.d && "exclusive" === this.options.mode && (this.d.b.bottom = this.b.top);
    if(this.d && "stacked" === this.options.mode) {
      for(this.options.offset = this.d.options.offset + (this.d.f ? this.d.a : this.d.c).offsetHeight, a = this;a = a.d;) {
        a.b.bottom -= this.height
      }
    }
    clearTimeout(this.A);
    this.A = setTimeout(this.k, 0)
  }, k:function() {
    this.f ? this.p() : this.e ? this.q(this.a) : this.l(this.a);
    this.i()
  }, n:["left", "top", "right", "bottom"], o:["padding-", "border-"], r:function(a, b) {
    var c = getComputedStyle(b), d = g(b);
    a.style.width = d.width + "px";
    a.style.left = d.left + "px";
    for(d = 0;d < this.o.length;d++) {
      for(var e = 0;e < this.n.length;e++) {
        var f = this.o[d] + this.n[e];
        a.style[f] = c[f]
      }
    }
  }, p:function() {
    this.a.style.cssText = this.B
  }};
  h && (h.fn.sticky = function(a) {
    return this.each(function(b, c) {
      var d = h(c), e = new f(d[0], a);
      d.data("sticky", e)
    })
  })
})(window.jQuery || window.Zepto);

