'use strict';(function(k){function q(a){for(var c=1,b=arguments.length;c<b;c++){var e=arguments[c],d;for(d in e)a[d]=e[d]}return a}function h(a){var c={top:0,left:0,right:0,bottom:0,width:0,height:0},b=a.getBoundingClientRect();c.top=b.top+(window.pageYOffset||document.documentElement.scrollTop);c.left=b.left+(window.pageXOffset||document.documentElement.scrollLeft);c.width=a.offsetWidth;c.height=a.offsetHeight;c.right=document.width-b.right;c.bottom=window.innerHeight+(window.pageYOffset||document.documentElement.scrollTop)-
b.bottom;return c}function l(a,c){var b=getComputedStyle(c),e=h(c),d=0,f=0;"border-box"!==b["box-sizing"]&&(d=~~b.paddingLeft.slice(0,-2),f=~~b.paddingRight.slice(0,-2));a.style.width=e.width-d-f+"px";a.style.left=e.left+"px";for(e=0;e<m.length;e++)for(d=0;d<n.length;d++)f=m[e]+n[d],a.style[f]=b[f]}function g(){this.create.apply(this,arguments)}var p=["object","iframe","embed","img"],n=["left","top","right","bottom"],m=["padding-","border-"];g.list=[];g.prototype={options:{offset:0,restrictWithin:null,
vAlign:"top",stickyClass:"is-stuck",stubClass:"sticky-stub",mode:"stacked",collapseStacked:!0,prevSticky:null},create:function(a,c){if(a.dataset.stickyId)return console.log("Sticky already exist");this.el=a;this.parent=this.el.parentNode;this.options=q({},this.options,a.dataset,c);this.restrictWithin="string"===typeof this.options.restrictWithin?document.body.querySelector(this.options.restrictWithin):this.options.restrictWithin;this.options.offset=parseFloat(this.options.offset)||0;this.el.dataset.stickyId=
g.list.length;g.list.push(this);this.isBottom=this.isFixed=!1;this.isTop=!0;this.restrictBox={top:0,bottom:9999};this.height=0;this.parentBox={top:0,height:0};var b=this.el;if(this.options.prevSticky)b="string"===typeof this.options.prevSticky?document.querySelector(this.options.prevSticky):this.options.prevSticky,b.dataset.stickyId&&g.list[b.dataset.stickyId]&&(this.prevSticky=g.list[b.dataset.stickyId],this.prevSticky.nextSticky=this);else for(;null!==(b=b.previousSibling);)if(1===b.nodeType&&void 0!==
b.dataset.stickyId){this.prevSticky=g.list[b.dataset.stickyId];this.prevSticky.nextSticky=this;break}for(var b=this.el.cloneNode(!0),e=0;e<p.length;e++)for(var d=b.querySelectorAll(p[e]),f=d.length;f--;)d[f].removeAttribute("src"),d[f].removeAttribute("href"),d[f].removeAttribute("rel"),d[f].removeAttribute("srcdoc"),"SCRIPT"===d[f].tagName&&d[f].parentNode.replaceChild(d[f]);this.stub=b;this.stub.classList.add(this.options.stubClass);this.stub.style.visibility="hidden";this.stub.style.display="none";
this.parent.insertBefore(this.stub,this.el);this.initialStyle=this.el.style.cssText;this.initialDisplay=getComputedStyle(this.el).display;"static"==window.getComputedStyle(this.parent).position&&(this.parent.style.position="relative");this.check=this.check.bind(this);this.recalc=this.recalc.bind(this);this.adjustSizeAndPosition=this.adjustSizeAndPosition.bind(this);this.recalc();document.addEventListener("scroll",this.check);window.addEventListener("resize",this.recalc);document.addEventListener("sticky:recalc",
this.recalc)},check:function(){var a=window.pageYOffset||document.documentElement.scrollTop;this.isFixed?(!this.isTop&&a+this.options.offset+this.height>=this.restrictBox.bottom&&this.parkBottom(),!this.isBottom&&a+this.options.offset<=this.restrictBox.top&&this.parkTop()):(this.isTop||this.isBottom)&&a+this.options.offset>this.restrictBox.top&&(a+this.options.offset+this.height<this.restrictBox.bottom?this.stick():this.isBottom||(this.stick(),this.parkBottom()))},parkTop:function(){this.el.style.cssText=
this.initialStyle;this.el.classList.remove(this.options.stickyClass);this.stub.style.display="none";this.isFixed=!1;this.isTop=!0;this.isBottom=!1},stick:function(){this.stub.style.display=this.initialDisplay;this.makeStickedStyle(this.el);this.isFixed=!0;this.isBottom=this.isTop=!1},parkBottom:function(){this.el.classList.remove(this.options.stickyClass);this.makeParkedBottomStyle(this.el);this.isFixed=!1;this.isBottom=!0;this.isTop=!1},makeParkedBottomStyle:function(a){a.style.cssText=this.initialStyle;
a.style.position="absolute";a.style.top=this.restrictBox.bottom-this.parentBox.top-this.height+"px";l(a,this.stub);a.style.left=this.stub.offsetLeft+"px"},makeStickedStyle:function(a,c){a.style.cssText=this.initialStyle;a.style.position="fixed";a.style.top=this.options.offset+"px";a.classList.add(this.options.stickyClass);l(a,c||this.stub)},recalc:function(){var a=this.isTop?this.el:this.stub;this.parentBox=h(this.parent);this.height=a.offsetHeight;if(this.restrictWithin instanceof Element){var c=
h(this.restrictWithin);this.restrictBox.top=Math.max(c.top,h(a).top);this.restrictBox.bottom=this.restrictWithin.offsetHeight+c.top}else this.restrictWithin instanceof Object?this.restrictBox=this.restrictWithin:(this.restrictBox.top=h(a).top,this.restrictBox.bottom=this.parentBox.height+this.parentBox.top);if(this.prevSticky)if("exclusive"===this.options.mode)this.prevSticky.restrictBox.bottom=this.restrictBox.top;else if("stacked"===this.options.mode){var c=this.prevSticky.isTop?this.prevSticky.el:
this.prevSticky.stub,b;if(b=this.options.collapseStacked){b=a.offsetLeft;var a=a.offsetLeft+a.offsetWidth,e=c.offsetLeft,d=c.offsetWidth+c.offsetLeft;b=!!(a<e&&b<e||a>d&&b>d)}if(b)this.options.offset=this.prevSticky.options.offset;else for(this.options.offset=this.prevSticky.options.offset+c.offsetHeight,c=this;c=c.prevSticky;)c.restrictBox.bottom-=this.height}clearTimeout(this._updTimeout);this._updTimeout=setTimeout(this.adjustSizeAndPosition,0)},adjustSizeAndPosition:function(){this.isTop?this.el.style.cssText=
this.initialStyle:this.isBottom?this.makeParkedBottomStyle(this.el):this.makeStickedStyle(this.el);this.check()}};k?k.fn.sticky=function(a){return this.each(function(c,b){var e=k(b),d=new g(e[0],a);e.data("sticky",d)})}:window.Sticky=g})(window.jQuery||window.Zepto);
